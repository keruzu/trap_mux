{
    "$id": "https://github.com/keruzu/trapmux/schema/trapmux.json",
    "description": "SNMP Trap Mux Configuration",
    "properties": {
        "filters": {
            "description": "A filter matches a condition and then executes an action",
            "items": {
                "properties": {
                    "action": {
                        "type": "string"
                    },
                    "plugin_args": {
                        "additionalProperties": {
                            "type": "string"
                        },
                        "type": "object"
                    }
                },
                "type": "object"
            },
            "title": "Filters",
            "type": "array"
        },
        "general": {
            "properties": {
                "plugin_path": {
                    "default": "txPlugins",
                    "description": "Path to loadable plugins",
                    "title": "Plugin Path",
                    "type": "string"
                }
            },
            "title": "General Settings",
            "type": "object"
        },
        "ipsets": {
            "description": "An IP set is a named grouping of IP references eg CIDR, regexp, IP",
            "title": "IP Sets",
            "type": "object"
        },
        "listener": {
            "description": "Settings that control SNMP trap reception",
            "properties": {
                "auth_password": {
                    "description": "Password for authentication",
                    "format": "password",
                    "title": "Authentication Password",
                    "type": "string"
                },
                "auth_protocol": {
                    "description": "Protocol for authenticating a connection",
                    "enum": [
                        "NoAuth",
                        "SHA",
                        "MD5"
                    ],
                    "title": "Authentication Protocol",
                    "type": "string"
                },
                "gosnmp_debug": {
                    "default": false,
                    "description": "Show verbose logging of the underlying GoSNMP library",
                    "title": "GoSNMP Debug",
                    "type": "boolean"
                },
                "gosnmp_debug_logfile_name": {
                    "description": "Optional name to store debug-level information, otherwise goes to stdout",
                    "title": "GoSNMP Debug Logging File Name",
                    "type": "string"
                },
                "hostname": {
                    "description": "For reporting purposes, how the system records its name",
                    "title": "Hostname",
                    "type": "string"
                },
                "ignore_versions": {
                    "description": "SNMP versions to support receive traps",
                    "enum": [
                        "v1",
                        "v2c",
                        "v3"
                    ],
                    "title": "SNMP Ignore Versions",
                    "type": "string"
                },
                "listen_address": {
                    "default": "0.0.0.0",
                    "description": "What IPv4 / IPv6 address should this listen on?",
                    "title": "Listening Address",
                    "type": "string"
                },
                "listen_port": {
                    "default": 162,
                    "description": "Receive SNMP traps on this port",
                    "title": "Listening Port",
                    "type": "number"
                },
                "msg_flags": {
                    "description": "Authentication options for SNMP v3",
                    "enum": [
                        "NoAuthNoPriv",
                        "AuthNoPriv",
                        "AuthPriv"
                    ],
                    "title": "SNMP v3 Security Options",
                    "type": "string"
                },
                "privacy_password": {
                    "description": "Password for privacy",
                    "format": "password",
                    "title": "Privacy Password",
                    "type": "string"
                },
                "privacy_protocol": {
                    "description": "Protocol for securing an existing connection",
                    "enum": [
                        "NoPriv",
                        "AES",
                        "DES"
                    ],
                    "title": "Privacy Protocol",
                    "type": "string"
                },
                "snmp_community": {
                    "description": "The SNMP Community is used as a simple control to prevent snooping",
                    "title": "SNMP Community",
                    "type": "string"
                },
                "username": {
                    "description": "User name used to authenticate",
                    "title": "Username",
                    "type": "string"
                }
            },
            "title": "SNMP Trap Listener Configuration",
            "type": "object"
        },
        "logging": {
            "properties": {
                "compress_rotated_logs": {
                    "default": true,
                    "description": "Should old logs be compressed?",
                    "title": "Rotated Log Compression",
                    "type": "boolean"
                },
                "level": {
                    "default": "info",
                    "description": "Amount of logging detail to include",
                    "enum": [
                        "trace",
                        "debug",
                        "info",
                        "warning",
                        "error",
                        "critical"
                    ],
                    "title": "Log Level",
                    "type": "string"
                },
                "log_age_max_days": {
                    "description": "Age in days of backup files to keep, maximum",
                    "title": "Log File Retention",
                    "type": "number"
                },
                "log_backups_max": {
                    "default": 7,
                    "description": "Number of backup files to keep, maximum",
                    "minimum": 0,
                    "title": "Log File Backups",
                    "type": "number"
                },
                "log_size_max": {
                    "default": 1024,
                    "description": "Size in MB",
                    "title": "Log Size (Max)",
                    "type": "number"
                }
            },
            "title": "Logging Configuration",
            "type": "object"
        },
        "reporting": {
            "description": "These plugins determine what metrics to record and how to expose them",
            "items": {
                "properties": {
                    "action": {
                        "description": "Name of the plugin",
                        "title": "Plugin",
                        "type": "string"
                    },
                    "plugin_args": {
                        "additionalProperties": {
                            "type": "string"
                        },
                        "type": "object"
                    }
                },
                "type": "object"
            },
            "title": "Metric Reporting Plugin Configuration",
            "type": "array"
        }
    },
    "title": "SNMP Trap Mux",
    "type": "object"
}
